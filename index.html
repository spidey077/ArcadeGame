<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Laser Bounce Madness</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    overflow: hidden;
    background: #000;
    font-family: 'Segoe UI', Tahoma;
  }

  canvas {
    display: block;
    background: #111;
    border: 3px solid #0ff;
    box-shadow: 0 0 25px #0ff;
    border-radius: 10px;
  }

  /* MAIN MENU */
  #menu {
    position: absolute;
    top:0; left:0;
    width:100%; height:100%;
    background: rgba(0,0,0,0.9);
    color:#0ff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    z-index:20;
  }

  #menu h1 {
    font-size: 64px;
    margin-bottom: 10px;
    text-shadow: 0 0 20px #0ff;
  }

  #menu p {
    font-size: 20px;
    margin-bottom: 30px;
    color:#0ff;
  }

  #menu button {
    padding: 12px 35px;
    font-size: 26px;
    border:none;
    background:#0ff;
    color:#111;
    cursor:pointer;
    border-radius:8px;
    transition:0.2s;
  }
  #menu button:hover{
    background:#0aa;
  }

  /* SCORE */
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    color: #0ff;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
    z-index:5;
  }

  /* GAME OVER */
  #gameOver {
    position: absolute;
    top:0; left:0;
    width:100%; height:100%;
    background: rgba(0,0,0,0.85);
    color:#0ff;
    display:flex;
    flex-direction: center;
    justify-content: center;
    align-items: center;
    font-size: 40px;
    font-weight: bold;
    text-shadow: 0 0 20px #0ff;
    visibility:hidden;
    z-index: 10;

  }

 #gameOver button {
   padding: 12px 35px;
    font-size: 26px;
    border:none;
    background:#0ff;
    color:#111;
    cursor:pointer;
    border-radius:8px;
    transition:0.2s;
}

  #gameOver button:hover {
    background:#0aa;
  }
  #gameContainer {
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
}
#highScore {
  position: absolute;
  top: 10px;
  right: 10px;
  color: #0ff;
  font-size: 24px;
  font-weight: bold;
  text-shadow: 0 0 10px #0ff, 0 0 20px #0ff;
  z-index: 5;
}

</style>
</head>
<body>

<!-- MAIN MENU -->
<div id="menu">
  <h1>Laser Bounce Madness</h1>
  <p>Move with Arrow Keys â€¢ Shoot with Space</p>
  <button onclick="startGame()">Start Game</button>
</div>

<div id="score">Score: 0</div>
<div id="highScore">High Score: 0</div>

<!-- GAME OVER -->
<div id="gameOver">
  Game Over! <span id="finalScore"></span>
  <button onclick="restartGame()">Restart</button>
</div>
<div id="gameContainer">
  <canvas id="game"></canvas>
</div>

<!-- Sounds -->
<audio id="laserSound" src="/laser.mp3"></audio>
<audio id="hitSound" src="/hit.wav"></audio>
<audio id="bounceSound" src="/bounce sound.wav"></audio>
<audio id="bgMusic" src="/bg.mp3"></audio>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

const laserSound = document.getElementById('laserSound');
const hitSound = document.getElementById('hitSound');
const bounceSound = document.getElementById('bounceSound');
const bgMusic = document.getElementById('bgMusic');
document.addEventListener("click", () => {
  const music = document.getElementById("bgMusic");
  music.play();
}, { once: true });

const menu = document.getElementById('menu');
const gameOverDiv = document.getElementById('gameOver');
const finalScoreSpan = document.getElementById('finalScore');
let gameRunning = false;
let highScore = parseInt(localStorage.getItem("laserBounceHighScore")) || 0;
document.getElementById("highScore").innerText = `High Score: ${highScore}`;

function resizeCanvas() {
  canvas.width = window.innerWidth * 0.95;
  canvas.height = window.innerHeight * 0.80;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

let WIDTH = canvas.width;
let HEIGHT = canvas.height;

// PLAYER (diamond shape)
const player = { x: WIDTH/2, y: HEIGHT/2, radius: 18, speed: 6, dx: 0, dy: 0 };

// ENEMIES
let enemies = [];
let ENEMY_COUNT = 5;

function randomVel() { return Math.random() * 1.5 + 3; }

function spawnEnemy() {
  enemies.push({
    x: Math.random()*(WIDTH-30)+15,
    y: Math.random()*(HEIGHT-30)+15,
    radius: 12,
    dx: (Math.random()<0.5? -1:1) * randomVel(),
    dy: (Math.random()<0.5? -1:1) * randomVel(),
    color: `hsl(${Math.random()*360},70%,50%)`,
    active:true
  });
}

for(let i=0;i<ENEMY_COUNT;i++) spawnEnemy();

// LASERS
let lasers = [];
const laserSpeed = 14;

// POWER ORBS
let powerOrbs = [];
function spawnOrb() {
  const orb = { x: Math.random()*(WIDTH-20)+10, y: Math.random()*(HEIGHT-20)+10, radius:8 };
  powerOrbs.push(orb);
  setTimeout(()=>{
    const idx = powerOrbs.indexOf(orb);
    if(idx>=0) powerOrbs.splice(idx,1);
  },10000);
}

const keys = {};
document.addEventListener('keydown', e=> keys[e.key]=true);
document.addEventListener('keyup', e=> keys[e.key]=false);

document.addEventListener('keydown', e=>{
  if(e.key===" " && (player.dx!==0 || player.dy!==0)){
    lasers.push({
      x: player.x,
      y: player.y,
      dx: player.dx * laserSpeed,
      dy: player.dy * laserSpeed,
      length: 20
    });
    laserSound.volume = 0.5;
    laserSound.currentTime=0; 
    laserSound.play();
  }
});

let score = 0;
let difficultyLevel = 0;
let frames=0;

function collide(a,b){
  return Math.hypot(a.x-b.x, a.y-b.y) < a.radius+b.radius;
}

function startGame() {
  menu.style.display = "none";
  gameRunning = true;
  bgMusic.volume = 0.4;
  bgMusic.play();
}


function gameOver() {
  gameRunning = false;

  if (score > highScore) {
    highScore = score;
    localStorage.setItem("laserBounceHighScore", highScore);
    document.getElementById("highScore").innerText = `High Score: ${highScore}`;
  }

  finalScoreSpan.innerText = score;
  gameOverDiv.style.visibility = "visible";
  bgMusic.pause();
}

function restartGame() {
  gameRunning = true;
  enemies = [];
  lasers = [];
  powerOrbs = [];
  score = 0;
  frames = 0;
  difficultyLevel = 0;

  for (let i = 0; i < ENEMY_COUNT; i++) spawnEnemy();

  player.x = WIDTH / 2;
  player.y = HEIGHT / 2;

  gameOverDiv.style.visibility = "hidden";
  bgMusic.currentTime = 0;
  bgMusic.play();
}

function update(){
  frames++;

  // Player movement
  player.dx = 0; player.dy = 0;
  if(keys["ArrowUp"]) player.dy = -player.speed;
  if(keys["ArrowDown"]) player.dy = player.speed;
  if(keys["ArrowLeft"]) player.dx = -player.speed;
  if(keys["ArrowRight"]) player.dx = player.speed;

  player.x += player.dx; 
  player.y += player.dy;

  player.x = Math.max(player.radius, Math.min(WIDTH-player.radius, player.x));
  player.y = Math.max(player.radius, Math.min(HEIGHT-player.radius, player.y));

  // Enemies
  enemies.forEach(e=>{
    if(!e.active) return;
    e.x+=e.dx;
    e.y+=e.dy;

    if(e.x<e.radius || e.x>WIDTH-e.radius){
      e.dx*=-1;
      bounceSound.volume = 0.2;
      bounceSound.play();
    }
    if(e.y<e.radius || e.y>HEIGHT-e.radius){
      e.dy*=-1;
      bounceSound.volume = 0.2;
      bounceSound.play();
    }

    if(collide(e,player)) gameOver();
  });

  // Lasers
  lasers.forEach((l,li)=>{
    l.x += l.dx;
    l.y += l.dy;

    if(l.x<0 || l.x>WIDTH || l.y<0 || l.y>HEIGHT){
      lasers.splice(li,1);
    }

    enemies.forEach(e=>{
      if(e.active && collide({x:l.x,y:l.y,radius:5}, e)){
        e.active=false;
        hitSound.volume = 0.4;
        hitSound.currentTime = 0;
        hitSound.play();
        score += 50;
      }
    });
  });

  // Orbs
  if(frames % 60 === 0) spawnOrb();

  powerOrbs.forEach((p,pi)=>{
    if(collide(player,p)){
      score += 100;
      powerOrbs.splice(pi,1);
    }
  });

  // Difficulty Increase
  if(score >= (difficultyLevel + 1) * 1000){
    difficultyLevel++;

    enemies.forEach(e=>{
      e.dx *= 1.1;
      e.dy *= 1.1;
    });

    spawnEnemy();
  }

  document.getElementById("score").innerText = `Score: ${score}`;
}

function draw(){
  ctx.fillStyle="#111";
  ctx.fillRect(0,0,WIDTH,HEIGHT);

  // PLAYER (diamond)
  ctx.fillStyle="yellow";
  ctx.shadowColor="yellow";
  ctx.shadowBlur=25;

  ctx.beginPath();
  ctx.moveTo(player.x, player.y - 18);
  ctx.lineTo(player.x + 18, player.y);
  ctx.lineTo(player.x, player.y + 18);
  ctx.lineTo(player.x - 18, player.y);
  ctx.closePath();
  ctx.fill();

  ctx.shadowBlur=0;

  // Enemies
  enemies.forEach(e=>{
    if(!e.active) return;
    ctx.fillStyle=e.color;
    ctx.shadowColor=e.color;
    ctx.shadowBlur=20;
    ctx.beginPath();
    ctx.arc(e.x,e.y,e.radius,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur=0;
  });

  // Lasers
  lasers.forEach(l=>{
    ctx.strokeStyle="cyan";
    ctx.lineWidth=4;
    ctx.shadowColor="cyan";
    ctx.shadowBlur=20;

    ctx.beginPath();
    ctx.moveTo(l.x, l.y);
    ctx.lineTo(l.x - l.dx * 0.1, l.y - l.dy * 0.1);
    ctx.stroke();

    ctx.shadowBlur=0;
  });

  // Orbs
  ctx.fillStyle="lime";
  ctx.shadowColor="lime";
  ctx.shadowBlur=25;
  powerOrbs.forEach(p=>{
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
  });
  ctx.shadowBlur=0;
}

function loop() {
  if (gameRunning) {
    update();
    draw();
  }
  requestAnimationFrame(loop);
}


loop();
</script>
</body>
</html>
